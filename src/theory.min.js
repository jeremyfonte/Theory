//Theory for JavaScript (Theory.js)
//Copyright (c) 2013 Jeremy Fonte
//Version 0.1.2
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

var isUnique=function(a){for(var d=a.length,c=!0,e=0;e<d;e++)if(a.indexOf(a[e])!==a.lastIndexOf(a[e])){c=!1;break}return c},makeUnique=function(a){for(var d=a.length,c=[],e=0;e<d;e++)-1===c.indexOf(a[e])&&c.push(a[e]);return c},intersect=function(a,d){for(var c=[],e=a.length,b=0;b<e;b++)-1!==d.indexOf(a[b])&&c.push(a[b]);return c},setUnion=function(a,d){var c=[],c=a.concat(d);return c=makeUnique(c)},cartesian=function(a,d){var c=[];al=a.length;bl=d.length;for(var e=0;e<al;e++)for(var b=0;b<bl;b++)c.push([a[e],
d[b]]);return c},isSubset=function(a,d){al=a.length;bl=d.length;if(al>bl)return!1;for(var c=0;c<al;c++)if(-1===d.indexOf(a[c]))return!1;return!0},isProperSubset=function(a,d){al=a.length;bl=d.length;return al>=bl?!1:isSubset(a,d)},isDisjoint=function(a,d){al=a.length;bl=d.length;for(var c=0;c<al;c++)if(-1!==a.indexOf(d[c]))return!1;return!0},setDiff=function(a,d){for(var c=[],e=a.length,b=0;b<e;b++)-1===d.indexOf(a[b])&&c.push(a[b]);return c},complement=function(a,d){return isSubset(d,a)?setDiff(a,
d):null},symDiff=function(a,d){return setDiff(setUnion(a,d),intersect(a,d))},sequence=function(a,d,c){for(var e=[],b=a.length,f=0;f<b;f++)e[f]=a[f];for(f=b;f<d;f++)e[f]=c(e);return e},reduce=function(a,d){for(var c=a.length,e=a[0],b=1;b<c;b++)e=d(a[b],e);return e},factors=function(a){for(var d=[],c=!1,e=2;e<a;e++)if(0===a%e){for(var c=!0,b=0;b<d.length;b++)if(0===e%d[b]){c=!1;break}c&&d.push(e)}return d},factorize=function(a){for(var d=factors(a),c=d.length,e=[],b=0;b<c;b++)e.push(0);for(var f=!1;!f;){for(b=
0;b<c;b++)0===a%d[b]&&(e[b]++,a/=d[b]);1===a&&(f=!0)}a=[];for(b=0;b<c;b++)a.push([d[b]],[e[b]]);return a},GCD=function(a,d){for(var c=!1,e;!c;)a>d?(e=a%d,0!==e?(a=d,d=e):c=!0):d>a&&(e=d%a,0!==e?(d=a,a=e):c=!0);return d>a?a:d},LCM=function(a,d){return a*d/GCD(a,d)},fib=function(a){return sequence([1,1],a,function(a){var c=a.length;return a[c-1]+a[c-2]})},factorial=function(a){a=sequence([1],a,function(a){al=a.length;return a[al-1]+1});return reduce(a,function(a,c){return c*a})},partialPerm=function(a,
d){return a>d?0:factorial(d)/factorial(d-a)},combination=function(a,d){return a>d?0:factorial(d)/(factorial(a)*factorial(d-a))},isFiniteGroup=function(a,d,c){for(var e=a.length,b=0;b<e;b++)for(var f=0;f<e;f++)if(-1===a.indexOf(d(a[b],a[f])))return!1;for(b=0;b<e;b++)if(d(a[b],c)!==a[b])return!1;for(b=0;b<e;b++)for(f=0;f<e;f++)for(c=0;c<e;c++)if(d(a[b],d(a[f],a[c]))!==d(d(a[b],a[f]),a[c]))return!1;c=!1;for(b=0;b<e;b++){for(f=0;f<e;f++)d(a[b],a[f])===d(a[f],a[b])&&(c=!0);if(!1===c)return!1;c=!1}return!0},
isAbelian=function(a,d,c){var e=a.length;if(!isFiniteGroup(a,d,c))return!1;for(c=0;c<e;c++)for(var b=c;b<e;b++)if(d(a[c],a[b])!==d(a[b],a[c]))return!1;return!0},isFiniteSubgroup=function(a,d,c,e){if(!isFiniteGroup(a,d,c))return!1;c=e.length;for(var b=0;b<c;b++)if(-1===a.indexOf(e[b]))return!1;for(b=0;b<c;b++)for(a=b;a<c;a++)if(-1===e.indexOf(d(e[b],e[a])))return!1;return!0},groupCenter=function(a,d,c){if(!isFiniteGroup(a,d,c))return null;c=a.length;for(var e=[],b=!0,f=0;f<c;f++){for(var h=0;h<c;h++)d(a[f],
a[h])!==d(a[h],a[f])&&(b=!1);b&&e.push(a[f]);b=!0}return e},centralizer=function(a,d,c,e){if(!isFiniteGroup(a,d,c)||-1===a.indexOf(e))return null;c=a.length;for(var b=[],f=0;f<c;f++)d(e,a[f])===d(a[f],e)&&b.push(a[f]);return b},operationExp=function(a,d,c,e){var b=d;if(d===c){if(1===e)return d;e--}for(var f=1;f<c;f++)b=a(c,d);return 1===e?b:operationExp(a,b,c,e-1)},orderOfElem=function(a,d,c,e){a=e;for(var b=0;a!==c;)b++,a=operationExp(d,e,e,b);return b},cyclicSubgroup=function(a,d,c,e){if(-1===a.indexOf(e))return null;
a=[];c=1;for(var b=e;1===c||b!==e;)a.push(b),c++,b=operationExp(d,e,e,c);return a},mean=function(a){return reduce(a,function(a,c){return a+c})/a.length},median=function(a){a.sort(function(a,b){return a-b});var d=a.length;if(0===d)return null;if(1===d)return a[0];var c=(d+1)/2;return 1===d%2?a[c-1]:(a[c-1.5]+a[c-0.5])/2},mode=function(a){for(var d=a.length,c=makeUnique(a),e=c.length,b=[],f=0;f<e;f++){for(var h=0,g=0;g<d;g++)c[f]===a[g]&&h++;b.push(h)}for(f=g=0;f<b.length;f++)b[f]>g&&(g=b[f]);a=[];
for(f=0;f<b.length;f++)b[f]===g&&a.push(f);b=[];for(g=0;g<a.length;g++)b.push(c[a[g]]);return b},max=function(a){for(var d=a[0],c=a.length,e=1;e<c;e++)a[e]>d&&(d=a[e]);return d},min=function(a){for(var d=a[0],c=a.length,e=1;e<c;e++)a[e]<d&&(d=a[e]);return d},range=function(a){return max(a)-min(a)},quartiles=function(a){a.sort(function(a,b){return a-b});theMedian=median(a);len=a.length;if(0===len)return null;if(1===len)return a[0];var d=(len+1)/2-1,c=[],e=[];e.push(theMedian);for(var b=0;b<len;b++)b<
d?c.push(a[b]):b>d&&e.push(a[b]);c.push(theMedian);a=median(c);e=median(e);return[a,e]},IQR=function(a){a=quartiles(a);return IQRVal=range(a)},outliers=function(a){var d=IQR(a),c=quartiles(a),e=a.length,b=1.5*d,d=min(c)-b,c=max(c)+b;outlierList=[];for(b=0;b<e;b++)(a[b]<d||a[b]>c)&&outlierList.push(a[b]);return outlierList},variance=function(a){for(var d=mean(a),c=a.length,e=[],b=0;b<c;b++)e.push(Math.pow(a[b]-d,2));return reduce(e,function(a,b){return a+b})/(c-1)},stdDeviation=function(a){a=variance(a);
return Math.sqrt(a)};
